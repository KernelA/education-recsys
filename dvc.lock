schema: '2.0'
stages:
  download_data:
    cmd: kaggle datasets download -d sharthz23/mts-library --unzip -p ./data/mts/raw
    outs:
    - path: ./data/mts/raw
      hash: md5
      md5: 4d3e0c84d99939f3a83b187da647fe33.dir
      size: 56317184
      nfiles: 3
  dump_data:
    cmd: python ./dump_data.py
    deps:
    - path: ./configs/data/mts_lib.yaml
      hash: md5
      md5: 7ed4d275db1a068f1ae81ff88bc10030
      size: 182
    - path: ./configs/dump.yaml
      hash: md5
      md5: 4e907fd2b255e19bc502d22b19c16cf4
      size: 84
    - path: ./data/mts/raw
      hash: md5
      md5: 4d3e0c84d99939f3a83b187da647fe33.dir
      size: 56317184
      nfiles: 3
    - path: ./dump_data.py
      hash: md5
      md5: 72d31c9afa22b2faedad44e65e367fa4
      size: 790
    outs:
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: dc0db0ff5d03064ad5224f8659311adc
      size: 2156181
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 7b199a5e38ea7d7232d5645734ff6830
      size: 497148
  cross_val:
    cmd: python ./train_recommender.py -m model=most_pop_per_age,most_pop,bm25,cosine,tfidf,als
    deps:
    - path: ./configs/cross_val.yaml
      hash: md5
      md5: c7d22cf25efc01a46a73f6bfeb0bc3d7
      size: 223
    - path: ./configs/model/inner_implicit_model
      hash: md5
      md5: a65aa1f9506e531600357794a63dbbc1.dir
      size: 309
      nfiles: 4
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: 28c97e5a522986083efb3cf0adc006ba
      size: 1883718
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 0c0525030480b8ccc30ac4fb55c60879
      size: 524265
    - path: ./train_recommender.py
      hash: md5
      md5: d399b93afdd633508d349bdc69472e7e
      size: 1787
    outs:
    - path: ./exp/multirun
      hash: md5
      md5: 3c8d5628260204a1e14b169d10e70945.dir
      size: 95421
      nfiles: 37
  cross_validate_fast_algorithms:
    cmd: python ./train_recommender.py -m model=most_pop_per_age,most_pop,bm25,cosine,tfidf
      hydra.sweep.dir=./exp/cross_val_fast
    deps:
    - path: ./configs/cross_val.yaml
      hash: md5
      md5: e69b74861060c2c1907233b4f5af361f
      size: 269
    - path: ./configs/model/bm25.yaml
      hash: md5
      md5: 6c2e1569c426b641620c2ef503e9be00
      size: 134
    - path: ./configs/model/cosine.yaml
      hash: md5
      md5: 6148b338bbd32f95640d4b5ca08268ac
      size: 137
    - path: ./configs/model/most_pop.yaml
      hash: md5
      md5: a7e696d354e8e373ba98256c66d0f251
      size: 70
    - path: ./configs/model/most_pop_per_age.yaml
      hash: md5
      md5: 541577b37fe15fea7e573c71f6116f46
      size: 76
    - path: ./configs/model/tfidf.yaml
      hash: md5
      md5: b7239c645418dd95c9a9b65e573799de
      size: 134
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: dc0db0ff5d03064ad5224f8659311adc
      size: 2156181
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 7b199a5e38ea7d7232d5645734ff6830
      size: 497148
    - path: ./train_recommender.py
      hash: md5
      md5: 72a726d295857389853de02bd8caf8da
      size: 2622
    outs:
    - path: ./exp/cross_val_fast
      hash: md5
      md5: 0ff7f28e2a82f0e1b96bfa0f8c61f372.dir
      size: 81171
      nfiles: 31
  cross_validate_als:
    cmd: python ./train_recommender.py -m model=als hydra.sweep.dir=./exp/cross_val_als
    deps:
    - path: ./configs/cross_val.yaml
      hash: md5
      md5: e69b74861060c2c1907233b4f5af361f
      size: 269
    - path: ./configs/model/als.yaml
      hash: md5
      md5: 7dca4f818a53ebdfc9294e611c5825fe
      size: 268
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: dc0db0ff5d03064ad5224f8659311adc
      size: 2156181
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 7b199a5e38ea7d7232d5645734ff6830
      size: 497148
    - path: ./train_recommender.py
      hash: md5
      md5: 72a726d295857389853de02bd8caf8da
      size: 2622
    outs:
    - path: ./exp/cross_val_als
      hash: md5
      md5: fa00a3953aad5296ddcad6b545d694b4.dir
      size: 20775
      nfiles: 7
  cross_validate_lightgm:
    cmd: python ./train_recommender.py -m model=lightfm hydra.sweep.dir=./exp/cross_val_lightfm
    deps:
    - path: ./configs/cross_val.yaml
      hash: md5
      md5: e69b74861060c2c1907233b4f5af361f
      size: 269
    - path: ./configs/model/lightfm.yaml
      hash: md5
      md5: 1ffdd978f22abf747d20a1d7fa54dd93
      size: 400
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: dc0db0ff5d03064ad5224f8659311adc
      size: 2156181
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 7b199a5e38ea7d7232d5645734ff6830
      size: 497148
    - path: ./train_recommender.py
      hash: md5
      md5: 72a726d295857389853de02bd8caf8da
      size: 2622
    outs:
    - path: ./exp/cross_val_lightfm
      hash: md5
      md5: e728523485e9c4e839ad7c4ad1413be9.dir
      size: 18656
      nfiles: 7
  als_hyperparams_search:
    cmd: python ./train_recommender.py -m -cn als_optim
    deps:
    - path: ./configs/als_optim.yaml
      hash: md5
      md5: bd18f1d4c63ce052d9a3ff2cff0a8f8b
      size: 961
    - path: ./configs/model/als.yaml
      hash: md5
      md5: c2bfe41e6373f266e3f8d129196217d4
      size: 208
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 9c3d6ce18642c47955e917dd746330ea
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: 2951efbc9dfc29938a67c6d1b4601013
      size: 1883213
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 0c0525030480b8ccc30ac4fb55c60879
      size: 524265
    - path: ./train_recommender.py
      hash: md5
      md5: c65105fe3e3f629a2f6a218e6f890594
      size: 1809
    outs:
    - path: ./exp/hyperparams_als
      hash: md5
      md5: a97defa6f976a19f04488584ee790284.dir
      size: 525086
      nfiles: 181
  lightfm_hyperparams_search:
    cmd: python ./train_recommender.py -m -cn lightfm_optim
    deps:
    - path: ./configs/lightfm_optim.yaml
      hash: md5
      md5: 38c6740bdfe41aafff2ec1209dbad05c
      size: 903
    - path: ./configs/model/lightfm.yaml
      hash: md5
      md5: 76e6f0f3d7799d22b26aa104e4502381
      size: 327
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 9c3d6ce18642c47955e917dd746330ea
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: 2951efbc9dfc29938a67c6d1b4601013
      size: 1883213
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 0c0525030480b8ccc30ac4fb55c60879
      size: 524265
    - path: ./train_recommender.py
      hash: md5
      md5: c65105fe3e3f629a2f6a218e6f890594
      size: 1809
    outs:
    - path: ./exp/hyperparams_light_fm
      hash: md5
      md5: 261fb6570e06b527fd587cb374f217d3.dir
      size: 149547
      nfiles: 61
  nn_gen_pos_neg_samples:
    cmd: python ./nn_gen_pos_neg_samples.py
    deps:
    - path: ./configs/gen_samples.yaml
      hash: md5
      md5: c7e984adafc6070b7d39cc99eae72a09
      size: 356
    - path: ./data/mts/dump/interactions.parquet
      hash: md5
      md5: 234b9ef93d3592e00bfe1bc6b368fad7
      size: 11186434
    - path: ./data/mts/dump/items.parquet
      hash: md5
      md5: dc0db0ff5d03064ad5224f8659311adc
      size: 2156181
    - path: ./data/mts/dump/users.parquet
      hash: md5
      md5: 7b199a5e38ea7d7232d5645734ff6830
      size: 497148
    - path: ./nn_gen_pos_neg_samples.py
      hash: md5
      md5: 10b534880a1335256cf58b92a2c11401
      size: 5077
    outs:
    - path: ./exp/neural-net/data
      hash: md5
      md5: ae90ee235d8c38ea1d101734f5195840.dir
      size: 10512394
      nfiles: 9
  nn_process_features:
    cmd: python ./nn_process_features.py
    deps:
    - path: ./configs/process_features.yaml
      hash: md5
      md5: db64c4c4846ac05498bbc684c9ff1d3f
      size: 268
    - path: ./exp/neural-net/data/features
      hash: md5
      md5: f80422e0eb500c2361efee83a9febf1e.dir
      size: 2488323
      nfiles: 2
    - path: ./nn_process_features.py
      hash: md5
      md5: 1aef0daa1fecf9b00c98d6762a2ab72a
      size: 1077
    outs:
    - path: ./exp/neural-net/features-processed
      hash: md5
      md5: b82ffa404138911f77f795b1fa388a62.dir
      size: 2752392
      nfiles: 6
  nn_train:
    cmd: python ./nn_train.py
    deps:
    - path: ./configs/nn_rec.yaml
      hash: md5
      md5: a97a23c2ec287c08c8690e877fb995d4
      size: 469
    - path: ./exp/neural-net/data
      hash: md5
      md5: ae90ee235d8c38ea1d101734f5195840.dir
      size: 10512394
      nfiles: 9
    - path: ./exp/neural-net/features-processed
      hash: md5
      md5: b82ffa404138911f77f795b1fa388a62.dir
      size: 2752392
      nfiles: 6
    - path: ./nn_train.py
      hash: md5
      md5: 8546dbd1721b052824f36dd8590dacdf
      size: 5657
    outs:
    - path: ./exp/neural-net/training
      hash: md5
      md5: 3369a5d75ca42a388b775bf3c4dedae2.dir
      size: 133151437
      nfiles: 9
